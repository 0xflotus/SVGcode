import{l as t}from"./vendor.73377355.js";self.addEventListener("message",(async a=>{const{imageData:e,config:s}=a.data,o=await(async(a,e,s)=>{const o=(t=>{const a={};for(let e=0;e<t.data.length;e+=4){const s=t.data[e],o=t.data[e+1],n=t.data[e+2],r=t.data[e+3];if(0===r)continue;const c=`${s},${o},${n},${r}`;a[c]?a[c].push(e):a[c]=[e]}return a})(a);let n="",r="",c="";const l=[];let i=0;for(const[f,p]of Object.entries(o)){const o=new ImageData(a.width,a.height);o.data.fill(255);const n=p.length;if(!(n<=e.turdsize)){for(let t=0;t<n;t++){const a=p[t];o.data[a]=0,o.data[a+1]=0,o.data[a+2]=0,o.data[a+3]=255}l.push(new Promise((async a=>{let n=await t(o.data,o.width,o.height,e);n=n.replace('fill="#000000" stroke="none"',`fill="rgba(${f})" stroke-width="1px" stroke="rgba(${f})"`),i++,s.postMessage({processed:i,total:d}),console.log("Potraced %c■■",`color: rgba(${f})`),a(n)})))}}const d=l.length,g=await Promise.all(l);for(const t of g)n||(n=t.replace(/(.*?<svg[^>]+>)(.*?)(<\/svg>)/,"$1"),r=t.replace(/(.*?<svg[^>]+>)(.*?)(<\/svg>)/,"$3"),c=n),c+=t.replace(/(.*?<svg[^>]+>)(.*?)(<\/svg>)/,"$2");return c+=r,c})(e,s,a.ports[1]);a.ports[0].postMessage({result:o})}));
