import{l as t}from"./vendor.4693f76e.js";self.addEventListener("message",(async a=>{const{imageData:e,config:s}=a.data,n=await(async(a,e)=>{const s=(t=>{const a={};for(let e=0;e<t.data.length;e+=4){const s=t.data[e],n=t.data[e+1],o=t.data[e+2],r=t.data[e+3];if(0===r)continue;const i=`${s},${n},${o},${r}`;a[i]?a[i].push(e):a[i]=[e]}return a})(a);let n="",o="",r="";for(const[i,c]of Object.entries(s)){const s=new ImageData(a.width,a.height);s.data.fill(255);const d=c.length;if(d<=e.turdsize)continue;for(let t=0;t<d;t++){const a=c[t];s.data[a]=0,s.data[a+1]=0,s.data[a+2]=0,s.data[a+3]=255}let l=await t(s.data,s.width,s.height,e);l=l.replace('fill="#000000" stroke="none"',`fill="rgba(${i})" stroke-width="1px" stroke="rgba(${i})"`),n||(n=l.replace(/(.*?<svg[^>]+>)(.*?)(<\/svg>)/,"$1"),o=l.replace(/(.*?<svg[^>]+>)(.*?)(<\/svg>)/,"$3"),r=n),r+=l.replace(/(.*?<svg[^>]+>)(.*?)(<\/svg>)/,"$2")}return r+o})(e,s);a.ports[0].postMessage({result:n})}));
